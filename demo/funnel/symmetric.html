<html>
  <head>
    <script src="https://unpkg.com/react@15/dist/react.min.js"></script>
    <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
    <script src="https://cdn.bootcss.com/babel-core/5.8.38/browser.min.js"></script>
    <script src="https://unpkg.alipay.com/@ali/bizcharts@3.0.0-rc5.4/dist/bizcharts"> </script>
    <script type="text/javascript" src="https://unpkg.alipay.com/@antv/data-set@0.5.2/build/data-set.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    
  </head>
  <body>
      <div id="mountNode" ></div>
      <script type="text/babel">
      const { Chart, Geom, Axis, Tooltip, Coord, Label, Legend, View, Guide, Shape, Facet } = window.BizCharts;
      const { Text } = Guide;
const data = [
  { action: '访问', visitor: 500, site: '站点1' },
  { action: '浏览', visitor: 400, site: '站点1' },
  { action: '交互', visitor: 300, site: '站点1' },
  { action: '下单', visitor: 200, site: '站点1' },
  { action: '完成', visitor: 100, site: '站点1' },
  { action: '访问', visitor: 550, site: '站点2' },
  { action: '浏览', visitor: 420, site: '站点2' },
  { action: '交互', visitor: 280, site: '站点2' },
  { action: '下单', visitor: 150, site: '站点2' },
  { action: '完成', visitor: 80, site: '站点2' }
];
data.sort(function(obj1, obj2){ // 从小到大
  return obj1.visitor - obj2.visitor;
});

let id = 0;
ReactDOM.render((
  <Chart height={window.innerHeight} data={data} axis={false} padding={[ 30, 120, 95 ]} forceFit>
    <Tooltip showTitle={false} crosshairs={false} itemTpl='<li data-index={index} style="margin-bottom:4px;"><span style="background-color:{color};" class="g2-tooltip-marker"></span>{name}<br/><span style="padding-left: 16px">{value}</span></li>' />
    <Legend reversed={true} />
    <Facet type='mirror' fields={[ 'site' ]} transpose={true} padding={0} >
      {(view, facet) => {
      return(
        <View data={facet.data} key={(id++)}>
        <Geom type='interval' position='action*visitor' color={['action', [ '#BAE7FF', '#69C0FF', '#40A9FF', '#1890FF', '#0050B3' ]]} shape='funnel' tooltip={['site*action*visitor', (site, action, visitor) => {
                return {
                  name: site,
                  value: action + ': ' + visitor
                };
              }]}
          style={{lineWidth: 1,
                stroke: '#fff'}}/>

        {data.map(obj => {
          if (obj.site === facet.colValue) {
            return (<Guide key={id++}>
              <Text top={true} position={[obj.action, 'min']} content={obj.visitor} style={{fill: '#fff',
                  fontSize: '12',
                    textAlign: facet.colIndex ? 'start' : 'end',
                      shadowBlur: 2,
                        shadowColor: 'rgba(0, 0, 0, .45)'}}
                offsetX={facet.colIndex ? 10 : -10}/>
            </Guide>)
          }
        })}
        </View>
       );
      }
    }
    </Facet>
  </Chart>
), document.getElementById("mountNode"));
    </script>
  </body>
</html>