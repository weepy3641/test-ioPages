<html>
  <head>
    <script src="https://unpkg.com/react@15/dist/react.min.js"></script>
    <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
    <script src="https://cdn.bootcss.com/babel-core/5.8.38/browser.min.js"></script>
    <script src="https://unpkg.alipay.com/@ali/bizcharts@3.0.0-rc5.4/dist/bizcharts"> </script>
    <script type="text/javascript" src="https://unpkg.alipay.com/@antv/data-set@0.5.2/build/data-set.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script type="text/javascript" src="https://gw.alipayobjects.com/as/g/datavis/assets/1.0.1/jquery-3.2.1.min.js"></script>
    
  </head>
  <body>
      <div id="mountNode" ></div>
      <script type="text/babel">
      const { Chart, Geom, Axis, Tooltip, Coord, Label, Legend, View, Guide, Shape, G2 } = window.BizCharts;
      $.getJSON('/public/data/iris.json', function(data) {
        const { DataView } = DataSet;
        const dv = new DataView().source(data);
        dv.transform({
          type: 'fold',
          fields: [ 'SepalLength','SepalWidth','PetalLength','PetalWidth' ], // 展开字段集
          key: 'type',
          value: 'value'
        }).transform({
          type: 'bin.quantile',
          field: 'value',    // 计算分为值的字段
          as: '_bin',    // 保存分为值的数组字段
          groupBy: [ 'Species', 'type' ],
        });
        const colorMap = {
          'I. setosa': G2.Global.colors[0],
          'I. versicolor': G2.Global.colors[1],
          'I. virginica': G2.Global.colors[2]
        };
      ReactDOM.render((
        <Chart height={window.innerHeight} data={dv} padding={[ 20, 120, 95 ]} forceFit>
          <Tooltip crosshairs={{type:'rect'}} />
          <Legend marker='circle' />
          <Geom type="schema" position="type*_bin" shape='box' color={['Species', val => {
            return colorMap[val];
          }]}
          style={['Species', {
            stroke: 'rgba(0, 0, 0, 0.45)',
            fill: val => {
              return colorMap[val];
            },
            fillOpacity: 0.3
          }]}
          adjust='dodge' 
            />

        </Chart>
      ), document.getElementById("mountNode"));
      });
    </script>
  </body>
</html>